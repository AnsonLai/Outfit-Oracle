<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
  <title> Outfit Oracle | AI Powered Fashion</title>
  <link rel="shortcut icon" href="favicon.png">
  <meta name="author" content="Anson Lai">
  <meta name="application-name" contents="Outfit Oracle">
  <meta name="description"
    content="Outfit Oracle uses AI to suggest the perfect fashion trends for you.  It gives you outfit ideas based on your photos to look your best for any occassion!">
  <meta name="keywords" content="AI, fashion, recommendations, trends, shopping, wardrobe">
  <meta name="twitter:title" content="AI Powered Fashion">
  <meta name="twitter:description"
    content="Outfit Oracle uses AI to suggest the perfect fashion trends for you.  It gives you outfit ideas based on your photos to look your best for any occassion!">
  <!-- <meta name="twitter:domain" content="politepost.net"> -->
  <meta name="twitter:creator" content="@PharaohsVizier">
  <meta name="twitter:image" content="webpreview.png">
  <meta name="twitter:card" content="summary">
  <meta property="og:title" content="AI Powered Fashion">
  <meta property="og:description"
    content="Outfit Oracle uses AI to suggest the perfect fashion trends for you.  It gives you outfit ideas based on your photos to look your best for any occassion!">
  <!-- <meta property="og:url" content="https://politepost.net"> -->
  <!-- <meta property="og:site_name" content="PolitePost.net"> -->
  <meta property="og:type" content="website">
  <meta property="og:image" content="webpreview.png">
  <meta property="og:logo" content="logo.png">
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" value="en-US">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta property="og:locale" content="en_US">
  <meta name="language" content="en_US">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"
    integrity="sha512-LhccdVNGe2QMEfI3x4DVV3ckMRe36TfydKss6mJpdHjNFiV07dFpS2xzeZedptKZrwxfICJpez09iNioiSZ3hA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
</head>

<body class="d-flex flex-column h-100" onload="setup()" style="background-color: rgb(255, 255, 255);">

  <nav class="navbar navbar-light" style="background-color: rgb(255, 255, 255);">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <div style="height: 3rem; width: 4.5rem;">
          <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0.00 0.00 591.00 433.00">
            <path fill="#A7A5A5"
              d="   M 302.61 156.28   Q 322.21 156.75 338.75 160.54   C 386.98 171.62 432.23 193.20 473.41 220.35   C 493.68 233.71 515.63 250.72 536.43 266.47   A 0.37 0.36 -49.8 0 0 536.92 266.42   C 542.18 260.80 549.89 256.76 557.66 260.78   C 565.79 264.99 570.16 274.39 565.74 282.79   C 562.31 289.32 553.40 292.00 547.40 287.69   A 1.22 1.21 43.2 0 0 545.94 287.73   C 522.24 306.76 497.60 325.56 471.66 341.21   C 448.52 355.18 424.92 367.95 399.29 376.81   C 356.60 391.56 311.97 399.10 267.34 392.68   C 233.56 387.82 201.73 379.28 170.42 365.78   Q 161.50 361.94 152.47 357.02   Q 117.11 337.75 83.76 312.45   Q 61.36 295.47 50.58 286.98   Q 50.18 286.67 49.74 286.93   C 44.73 289.92 41.13 291.62 35.58 288.45   C 26.72 283.40 26.72 269.76 33.80 263.29   C 41.41 256.33 53.53 258.57 59.19 266.87   A 1.34 1.34 0.0 0 0 61.10 267.19   Q 78.17 254.47 94.98 242.53   Q 126.25 220.30 157.46 202.46   C 195.48 180.73 236.98 164.67 280.31 157.63   A 0.79 0.79 0.0 0 0 280.97 156.83   Q 280.76 150.99 281.13 145.01   C 282.12 129.28 290.39 115.61 304.76 108.57   C 310.86 105.58 317.96 102.90 322.55 99.83   C 334.61 91.77 340.69 77.76 336.39 63.48   C 326.51 30.63 279.35 31.76 271.62 66.12   Q 271.32 67.44 271.31 69.92   C 271.29 75.05 269.68 79.89 265.15 82.42   C 262.97 83.63 259.64 83.71 257.37 82.45   C 249.29 77.95 250.82 66.90 252.78 59.76   C 257.23 43.52 269.43 27.81 286.10 22.73   Q 322.97 11.47 346.48 39.51   Q 353.50 47.88 356.27 60.98   Q 360.76 82.17 350.25 99.50   C 342.06 113.00 329.49 119.82 315.33 125.59   C 301.08 131.39 300.74 141.95 302.01 155.72   Q 302.06 156.27 302.61 156.28   Z   M 353.21 189.22   C 322.01 171.28 281.93 171.22 250.51 188.62   C 227.59 201.32 212.37 222.74 204.99 247.74   C 202.87 254.92 201.87 262.92 201.53 270.25   C 200.02 303.52 214.42 332.82 239.88 353.86   C 265.50 375.02 300.95 379.83 332.10 370.33   C 369.45 358.95 397.60 324.99 401.69 286.10   Q 403.13 272.38 401.30 260.25   C 398.48 241.54 391.27 227.77 380.90 213.35   C 373.67 203.30 363.86 195.34 353.21 189.22   Z   M 83.74 287.48   C 123.43 318.35 166.92 347.07 215.92 360.53   A 0.34 0.34 0.0 0 0 216.26 359.96   C 201.35 344.51 188.61 322.80 184.27 302.00   Q 181.24 287.50 181.75 269.98   Q 182.91 230.63 207.20 200.64   Q 208.85 198.60 206.48 199.72   C 203.65 201.05 200.60 202.21 197.75 203.77   Q 190.72 207.63 175.68 215.42   Q 152.11 227.62 123.81 246.81   C 107.74 257.71 92.15 269.16 76.25 280.31   A 0.51 0.50 49.2 0 0 76.20 281.09   Q 79.82 284.43 83.74 287.48   Z   M 418.35 347.39   C 453.67 330.69 486.40 308.85 518.18 283.94   Q 520.31 282.26 522.60 280.99   A 0.29 0.29 0.0 0 0 522.63 280.50   Q 504.26 267.10 485.76 253.76   Q 444.06 223.68 398.41 201.58   Q 396.63 200.71 397.82 202.30   C 430.22 245.53 430.20 301.61 399.59 346.09   Q 394.78 353.09 388.21 358.49   Q 387.87 358.77 387.78 359.19   A 0.35 0.35 0.0 0 0 388.24 359.59   Q 403.62 354.36 418.35 347.39   Z" />
            <path fill="#A7A5A5"
              d="   M 377.54 313.04   C 360.37 347.81 322.88 363.94 285.03 356.61   C 256.52 351.09 235.73 332.78 224.47 306.25   C 214.84 283.56 217.29 252.67 229.84 231.37   Q 243.88 207.56 270.07 197.60   C 286.06 191.51 302.91 189.55 319.61 193.36   C 347.75 199.78 370.10 217.88 381.12 244.73   C 390.39 267.33 388.22 291.39 377.54 313.04   Z   M 297.74 243.60   A 24.95 24.95 0.0 0 0 272.79 218.65   A 24.95 24.95 0.0 0 0 247.84 243.60   A 24.95 24.95 0.0 0 0 272.79 268.55   A 24.95 24.95 0.0 0 0 297.74 243.60   Z   M 345.31 299.38   C 329.14 320.78 300.27 326.12 276.60 313.63   C 259.66 304.69 249.26 285.94 245.59 267.73   Q 244.44 262.07 243.45 256.47   Q 242.97 253.80 242.02 256.34   Q 235.89 272.66 240.65 290.95   C 249.09 323.34 276.67 338.89 308.75 336.86   C 335.16 335.18 356.32 318.43 363.99 293.00   C 364.97 289.73 365.37 286.32 365.84 282.86   C 368.69 261.80 360.79 242.33 344.93 228.50   Q 344.71 228.30 344.51 228.52   L 344.33 228.70   Q 344.20 228.84 344.33 228.98   Q 350.82 235.61 353.51 243.49   C 359.95 262.38 357.34 283.46 345.31 299.38   Z" />
          </svg>
        </div>
        <span class="pt-2" style="margin-left: 0.75rem; font-size: 2rem; color: #A7A5A5;">Outfit Oracle</span>
      </a>
    </div>
  </nav>


  <main class="flex-grow-1">
    <div class="container">
      <div class="row g-0">
        <div id="padding-container" class="d-none d-md-block" style="padding-top: 5rem; padding-bottom: 5rem;"></div>
        <div style="padding-top: 1rem; padding-bottom: 1rem;"></div>

        <div id="photoCollector" class="col-md-6 offset-md-3 bg-dark rounded shadow">
          <div class="row bg-white w-100 g-0 pt-5 pb-1 rounded-top text-dark text-center"
            style="background: linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url('openaivtestbg.png'); background-size: cover; background-position: center; ">
            <div class="col d-flex flex-column align-items-center">
              <div class="mb-3 pt-3 text-center text-dark" style="border-radius: .5rem; width: 50%; min-width: 200px;">
                <h2><strong>Need fashion advice?</strong></h2>
                <h6>Upload 2-3 photos of yourself and let our AI stylist do the rest!</h6>
                <br>
                <br>
                <br>
                <h6 class="text-muted"><small>Powered by OpenAI GPT4V</small></h6>
              </div>
            </div>
          </div>
          <!-- Separator -->
          <div class="row bg-white w-100 g-0 py-5 rounded-bottom text-dark">
            <div class="d-flex flex-column align-items-center">
              <div class="col d-flex flex-column align-items-center">
                <!-- Drop area -->
                <div id="drop-area" class="drop-area mb-3 p-3 text-center text-dark"
                  style="border: 2px dashed #6ca464; border-radius: .5rem; width: 50%; min-width: 200px;">
                  <p class="mb-0"><strong>Drop Photos Here</strong></p>
                </div>
              </div>
              <div class="d-flex align-items-center w-25 my-3">
                <hr class="flex-grow-1">
                <span class="mx-2">or</span>
                <hr class="flex-grow-1">
              </div>

              <!-- File input -->
              <div class="text-center mt-3">
                <input type="file" id="fileElem" accept="image/*" multiple style="display: none;">
                <label class="btn btn-success p-3 px-5" for="fileElem"><strong>Select Photos</strong></label>
              </div>
            </div>

            <!-- Container for the processed images -->
            <div id="image-container" class="d-flex justify-content-center align-items-center flex-wrap pt-3">
              <!-- Processed images will be appended here -->
            </div>

          </div>
        </div>

        <div id="formCollection" class="col-md-6 p-5 d-none">
          <form>
            <div class="mb-3">
              <label for="eventDescription" class="form-label h6">Event or Location</label>
              <input type="text" class="form-control" id="eventDescription" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
              <label for="styleDescription" class="form-label h6">Desired Style (optional)</label>
              <input type="text" class="form-control" id="styleDescription" aria-describedby="passwordHelp">
            </div>
          </form>
          <div class="d-flex justify-content-center">
            <button id="sendButton" class="btn btn-success mt-5 p-3 px-5" onclick="sendToAPI()"
              aria-describedby="sendHelp"><strong>Stylize me!</strong></button>
          </div>
          <div id="sendHelp" class="form-text text-center">Outfit Oracle and OpenAI will <em>immediately</em> delete your photos after we
            stylize you.</div>


          <div id="loader" class="container text-center my-4 d-none">
            <div class="spinner-grow" role="status" style="height: 0.5rem; width: 0.5rem;">
              <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow" role="status" style="height: 0.5rem; width: 0.5rem; -webkit-animation: .75s linear 0.25s infinite spinner-grow;
                animation: .75s linear 0.25s infinite spinner-grow;">
              <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow" role="status" style="height: 0.5rem; width: 0.5rem; -webkit-animation: .75s linear 0.5s infinite spinner-grow;
                animation: .75s linear 0.5s infinite spinner-grow;">
              <span class="visually-hidden">Loading...</span>
            </div>
            <div class="form-text">Analysis may take up to 30 seconds.</div>
          </div>
        </div>

      </div>

      <div class="row g-0">
        <div id="analysis-container" class="col my-5 bg-white text-dark rounded shadow d-none">
          <p class="h1 text-center pt-5" style="color:#A7A5A5">ANALYSIS</p>
          <p id="apiResponse" class="p-5"></p>
        </div>
      </div>

      <div class="row d-none">
        <h3>Base64 Encoded String:</h3>
        <button class="btn btn-secondary"
          onclick="copyToClipboard(document.getElementById('base64').innerText)"><small>Copy to
            Clipboard</small></button>
        <p id="base64" style="white-space: pre-wrap; word-break: break-all;"></p>
      </div>


    </div>
  </main>


  <footer class="footer mt-auto pt-3 pb-1 bg-white">
    <div class="footer-copyright text-center py-3">
      <div class="text-center">
        <div class="d-flex align-items-center justify-content-center">
          <div class="text-start d-inline-block align-center">
            <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js"
              data-name="bmc-button" data-slug="ansonlai" data-color="#FFDD00" data-emoji="" data-font="Lato"
              data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#000000"
              data-coffee-color="#ffffff"></script>
          </div>
          <div class="text-start d-inline-block align-center ms-3">
          </div>
        </div>
      </div>
      <p class="small mt-2">Want to support this site? Every dollar goes a long way to keep this
        site running.</p>
    </div>
  </footer>


</body>

<script>
  // Scripts to transition user through stages

  // Transition element changes, add this to tag 'style="opacity: 0; visibility: hidden; transition: visibility 0s linear 0.5s, opacity 0.5s linear;"'
  function showElement(element) {
    // Remove 'd-none' class if it exists
    element.classList.remove('d-none');
    // Set the initial state
    element.style.opacity = '0';
    element.style.visibility = 'hidden';
    element.style.transition = 'visibility 0s linear 0.5s, opacity 0.5s linear';
    // Start the transition
    setTimeout(() => {
      element.style.visibility = 'visible';
      element.style.opacity = '1';
    }, 10); // Start the opacity transition after a short delay
  }

  function hideElement(element) {
    // Set the transition properties
    element.style.transition = 'visibility 0s linear 0.5s, opacity 0.5s linear';
    // Start the transition
    element.style.opacity = '0';
    // After the transition is finished, hide the element
    setTimeout(() => {
      element.style.visibility = 'hidden';
      // Optionally, add 'd-none' class back if you want to remove the element from the document flow
      element.classList.add('d-none');
    }, 500); // Match the delay to the duration of the opacity transition
  }
</script>

<script>
  // Scripts to handle API call

  // Global messages array
  var messages = [
    {
      "role": "user",
      "content": [
      ]
    }
  ];

  var MAX_PHOTOS = 5;
  function addToMessageContent(dict) {

    if (messages[0]['content'].length < MAX_PHOTOS) {
      messages[0]['content'].unshift(dict);
    } else {
      // alert(`You cannot add more than ${MAX_PHOTOS} images.`);
    }
  }

  function processForm() {
    var eventDescription = document.getElementById('eventDescription').value;
    if (eventDescription == "") {
      eventDescription = "generic, everday"
    }
    var styleDescription = document.getElementById('styleDescription').value;
    if (styleDescription == "") {
      styleDescription = "n/a"
    }

    addToMessageContent({
      type: "text",
      text: `The occasion the individual is dressing for is: ${eventDescription}`
    });
    addToMessageContent({
      type: "text",
      text: `The individual mentions their desired style is: ${styleDescription}`
    });
  }

  function sendToAPI() {
    // The URL of the API endpoint
    const apiUrl = "https://gptvisionapiopenai.azurewebsites.net/outfit_oracle/";

    // Prepare the HTTP headers
    const headers = {
      "Content-Type": "application/json",
    };

    // Prepare the payload with the global messages array
    const payload = {
      model: "gpt-4-vision-preview",
      messages: messages,
      max_tokens: 800
    };

    // Process form to add more messages to the messages array
    processForm();

    document.getElementById('loader').classList.remove("d-none");
    document.getElementById('sendButton').disabled = true;
    // Send the POST request
    fetch(apiUrl, {
      method: "POST",
      headers: headers,
      body: JSON.stringify(payload)
    })
      .then(response => response.json())
      .then(data => handleAPIResponse(data)) // Pass the data to the new function
      .catch(error => {
        console.error('Error:', error);
        alert('We have tight content guidelines.  Please ensure there are no inappropriate photos, then refresh the page and try again.')
      });
  }

  function handleAPIResponse(data) {
    var converter = new showdown.Converter();
    converter.setOption('disableForced4SpacesIndentedSublists', true);
    converter.setOption('smartIndentationFix', true);

    let unhelpfulResponses = [
      `I'm sorry, I can't assist with that request.`,
      "I'm sorry, I cannot provide the assistance you're asking for.",
      "I'm sorry, I can't provide assistance with that request.",
      "I'm sorry, but I can't provide information based on these images.",
      "Unfortunately, I can't assist with that request.",
      "I'm sorry, I can't provide information about the person in the photo.",
      "I'm sorry, but I am unable to provide the service you are asking for.",
      "I'm sorry, I can't provide the requested analysis or suggestions."
    ];

    var text = data["response"]["choices"][0]['message']['content'];
    console.log(data["messages"])
    var html = converter.makeHtml(text);
    if (unhelpfulResponses.includes(text)) {
      throw new Error('GPT cannot assist.');
    }
    document.getElementById('apiResponse').innerHTML = html;
    document.getElementById('analysis-container').classList.remove("d-none");
    document.getElementById('loader').classList.add("d-none");
    document.getElementById('analysis-container').scrollIntoView({ behavior: 'smooth' });
    document.getElementById('padding-container').classList.add("d-none");
    document.getElementById('padding-container').classList.remove("d-md-block");
    // document.getElementById('padding-container').style.paddingTop = '1rem';
    // document.getElementById('padding-container').style.paddingBottom = '1rem';
  }
</script>
<script>
  // Scripts to handle and convert image inputs
  function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
  }

  function handleDrop(e) {
    let dt = e.dataTransfer;
    let files = dt.files;
    handleFiles(files);
  }

  function handleBrowse(e) {
    handleFiles(e.target.files);
  }

  function handleFiles(files) {
    ([...files]).forEach(processImage);
  }

  function copyToClipboard(base64Image) {
    if (!base64Image) {
      alert('No image has been processed yet!');
      return;
    }
    const elem = document.createElement('textarea');
    elem.value = base64Image;
    document.body.appendChild(elem);
    elem.select();
    document.execCommand('copy');
    document.body.removeChild(elem);
    alert('Base64 string copied to clipboard!');
  }

  function convertToBase64(file, callback) {
    const reader = new FileReader();
    reader.onload = function (event) {
      callback(event.target.result);
    };
    reader.readAsDataURL(file);
  }

  function displayImage(base64Image) {
    // Create an image element
    var imgElement = document.createElement('img');
    imgElement.src = base64Image;
    imgElement.style.maxWidth = '150px'; // Set a max width to fit on the screen
    imgElement.style.maxHeight = '150px';
    imgElement.style.marginTop = '5px';
    imgElement.style.marginRight = '5px';
    imgElement.style.marginLeft = '5px'; // Add some margin between the drop box and the image

    // Handle transition after files are uploaded
    // Append the image to the container
    document.getElementById('image-container').appendChild(imgElement);
    // Format image loader
    document.getElementById('image-container').style.marginTop = '5rem';
    // Reveal form and scroll to it
    document.getElementById('photoCollector').classList.remove("offset-md-3");
    document.getElementById('formCollection').classList.remove("d-none");
    document.getElementById('formCollection').scrollIntoView({ behavior: 'smooth' });
  }

  function processImage(file) {
    if (messages[0]['content'].length >= MAX_PHOTOS) {
      alert(`You cannot add more than ${MAX_PHOTOS} images.`);
      return; // Stop processing the new image
    }

    convertToBase64(file, function (base64) {
      let img = new Image();
      img.onload = function () {
        // Check again in case images were added since the process started
        if (messages[0]['content'].length >= MAX_PHOTOS) {
          return; // Stop the image processing if the limit is reached
        }
        let squareSize = Math.max(img.width, img.height);
        let canvas = document.createElement('canvas');
        canvas.width = canvas.height = squareSize;
        let ctx = canvas.getContext('2d');
        // ctx.fillStyle = 'white';
        // ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, (squareSize - img.width) / 2, (squareSize - img.height) / 2);
        let resizeCanvas = document.createElement('canvas');
        resizeCanvas.width = resizeCanvas.height = 512;
        let resizeCtx = resizeCanvas.getContext('2d');
        resizeCtx.drawImage(canvas, 0, 0, 512, 512);
        let dataURL = resizeCanvas.toDataURL('image/png');
        document.getElementById('base64').innerText = dataURL;
        // Save the Base64 string to a global variable for use in the API call
        window.currentBase64Image = dataURL.split(',')[1]; // Remove the Data URL prefix for pure Base64
        displayImage(dataURL);

        // Add new content to the global messages array
        addToMessageContent({
          type: "image_url",
          image_url: {
            url: `data:image/jpeg;base64,${window.currentBase64Image}`
          }
        });
      };
      img.src = base64;
    });
  }

  function setup() {
    let dropArea = document.getElementById('drop-area');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
    });

    dropArea.addEventListener('drop', handleDrop, false);
    document.getElementById('fileElem').addEventListener('change', handleBrowse, false);
  }
</script>

</html>